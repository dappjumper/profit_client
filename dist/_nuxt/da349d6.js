(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{323:function(t,e,o){"use strict";o.r(e);o(10),o(8),o(6),o(4),o(9);var r=o(2),n=o(35),c=o(34);function l(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(object);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,o)}return e}function d(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?l(Object(source),!0).forEach((function(e){Object(r.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):l(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}var v={name:"AddBotForm",props:["type"],data:function(){return{loading:!1,valid:!0,error:!1,errorString:"",token:"",tokenRules:[function(t){return!!t||"Token is required"}]}},methods:d(d({},Object(c.b)("user",["addToSet"])),{},{submit:function(){var t=this;if(!this.$refs.form.validate())return!1;this.loading=!0,n.a.user({path:"bot",method:"put",data:{token:this.token}}).then((function(e){if(t.loading=!1,!e.data.ok)return t.error=!0,t.errorString=e.data.error;t.addToSet({key:bots,data:e.data.bot_id}),t.$refs.form.reset()})).catch((function(e){t.loading=!1,t.error=!0,t.errorString=e}))}})},f=o(28),h=o(50),m=o.n(h),O=o(306),y=o(129),_=o(301),j=o(305),component=Object(f.a)(v,(function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("v-form",{ref:"form",attrs:{"lazy-validation":""},on:{submit:function(e){return e.preventDefault(),t.submit(e)}},model:{value:t.valid,callback:function(e){t.valid=e},expression:"valid"}},[o("v-text-field",{attrs:{rules:t.tokenRules,loading:t.loading,disabled:t.loading,label:"Token from @Botfather",required:""},model:{value:t.token,callback:function(e){t.token=e},expression:"token"}}),t._v(" "),o("v-alert",{attrs:{color:"red",dismissible:"",type:"error"},model:{value:t.error,callback:function(e){t.error=e},expression:"error"}},[t._v(t._s(t.errorString))]),t._v(" "),o("v-btn",{staticClass:"mr-4",attrs:{disabled:t.loading||!t.valid,color:"success",loading:t.loading,type:"submit"}},[t._v("\n    Continue\n  ")])],1)}),[],!1,null,null,null),D=component.exports;m()(component,{VAlert:O.a,VBtn:y.a,VForm:_.a,VTextField:j.a});var k=o(22),w=(o(313),o(48)),I={name:"BotListItem",mixins:[{data:function(){return{bot:null,ready:!1,extras:{},errorFor:{bot:null},loading:{active:!1}}},props:["botID"],mounted:function(){return w.a.boot(),this.botID?(this.bot=w.a.load("bot",this.botID,0),this.bot?(this.fetchAdditional(),this.ready=!0):void this.fetchBot(this.botID)):this.errorFor.bot="No bot ID specified"},methods:{getModuleOptions:function(t){this.bot.modules=this.bot.modules||{},this.bot.modules[t.id]=this.bot.modules[t.id]||{};for(var i=0;i<t.options.length;i++)this.bot.modules[t.id][t.options[i].id]=this.getOptionValue(t,t.options[i]);return t.options},getOptionValue:function(t,option){return void 0===this.bot.modules||void 0===this.bot.modules[t.id]||void 0===this.bot.modules[t.id][option.id]?option.default:this.bot.modules[t.id][option.id]},save:function(t){w.a.save("bot",t,this.bot)},fetchBot:function(t){var e=this;this.ready=!1,n.a.bot({botID:t,method:"get"}).then((function(o){w.a.save("bot",t,o),e.bot=o,e.bot.modules||(e.bot.modules={}),e.ready=!0,e.fetchAdditional()})).catch((function(t){e.errorFor.bot=t}))},setLazy:function(t,e){w.a.save("lazy",t,e),this.extras[t]=e,this.loading[t]=!1},fetchLazy:function(t){var e=this,o=t.pop();if(!o)return!1;var r=w.a.load("lazy",o,0);if(r)return this.setLazy(o,r),this.fetchLazy(t);n.a.basic({method:"get",path:o}).then((function(t){e.setLazy(o,t)})).catch((function(t){console.log(t)})).finally((function(){e.fetchLazy(t)}))},fetchAdditional:function(){for(var t=[],e=0,o=Object.entries(this.loading);e<o.length;e++){var r=Object(k.a)(o[e],2),n=r[0];r[1]&&t.push(n)}t.length&&this.fetchLazy(t)},setModule:function(t,data){var e=this;this.loading=Object.assign({},this.loading,Object(r.a)({},"module_"+t.id,!0)),n.a.bot({botID:this.botID,path:t.id,method:"patch",data:{data:data}}).then((function(o){e.bot.modules=e.bot.modules||{};for(var r=0,n=Object.entries(o);r<n.length;r++){var c=Object(k.a)(n[r],2),l=c[0],d=c[1];e.$set(e.bot.modules[t.id],l,d)}e.save(e.botID)})).catch((function(t){console.log(t,"some error")})).finally((function(){e.loading["module_"+t.id]=!1}))},setActivation:function(){var t=this;this.loading.active=!0,n.a.bot({botID:this.botID,path:"",method:"patch",data:{data:{active:!this.bot.active}}}).then((function(e){void 0!==e.active&&(t.bot.active=e.active,t.save(t.botID))})).catch((function(t){console.log(t)})).finally((function(){t.loading.active=!1}))}}}]},x=o(310),P=o(307),V=Object(f.a)(I,(function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("v-card",{staticClass:"mb-4",attrs:{color:"secondary",dark:""}},[o("div",{staticClass:"d-flex flex-no-wrap justify-space-between"},[t.ready?o("div",[o("v-card-title",[t._v(t._s(t.bot.t_info.first_name))]),t._v(" "),o("v-card-subtitle",[t._v("@"+t._s(t.bot.t_info.username))]),t._v(" "),o("v-card-text",[t._v(t._s(t.bot.active?"This bot is active.":"This bot is not active."))]),t._v(" "),o("v-card-actions",[o("v-btn",{attrs:{loading:t.loading.active,disabled:t.loading.active},on:{click:function(e){return t.setActivation(!t.bot.active)}}},[t._v("\n          "+t._s(t.bot.active?"De-activate":"Activate")+"\n        ")]),t._v(" "),o("v-btn",{attrs:{link:"",to:"/app/bots/#"+t.botID}},[t._v("\n          Settings\n        ")])],1)],1):o("div",[o("v-card-title",[t._v("Loading...")]),t._v(" "),o("v-card-subtitle",[t._v("Loading...")]),t._v(" "),o("v-card-text",[t._v("Loading...")]),t._v(" "),o("v-card-actions",[t._v("Loading...")])],1)])])}),[],!1,null,null,null),L=V.exports;function A(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(object);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,o)}return e}m()(V,{VBtn:y.a,VCard:x.a,VCardActions:P.a,VCardSubtitle:P.b,VCardText:P.c,VCardTitle:P.d});var B={name:"DashBots",layout:"app",components:{AddBotForm:D,BotListItem:L},computed:function(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?A(Object(source),!0).forEach((function(e){Object(r.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):A(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}({},Object(c.c)("user",["user"]))},S=o(321),C=o(330),z=o(322),T=Object(f.a)(B,(function(){var t=this.$createElement,e=this._self._c||t;return e("v-container",[e("v-row",{attrs:{dense:""}},[e("v-col",{attrs:{cols:"12"}},this._l(this.user.bots,(function(t){return e("BotListItem",{key:t,attrs:{botID:t}})})),1)],1),this._v(" "),e("v-row",{attrs:{dense:""}},[e("v-col",[e("h2",[this._v("Add bot")]),this._v(" "),e("AddBotForm")],1)],1)],1)}),[],!1,null,null,null);e.default=T.exports;m()(T,{VCol:S.a,VContainer:C.a,VRow:z.a})}}]);